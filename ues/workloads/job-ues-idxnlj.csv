label,query,query_hint
1a,SELECT COUNT(*) FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id AND mc.note NOT LIKE '%(as metro-goldwyn-mayer pictures)%' AND (mc.note LIKE '%(co-production)%' OR mc.note LIKE '%(presents)%') JOIN title AS t ON t.id = mc.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it ON it.info = 'top 250 rank' AND it.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = mc.movie_id,"/*+
IndexOnlyScan(it)
NestLoop(mi_idx it)

*/"
1b,SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it ON it.info = 'bottom 10 rank' AND it.id = mi_idx.info_type_id JOIN title AS t ON t.production_year BETWEEN 2005 AND 2010 AND t.id = mi_idx.movie_id JOIN movie_companies AS mc ON mc.movie_id = mi_idx.movie_id AND mc.note NOT LIKE '%(as metro-goldwyn-mayer pictures)%' JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id,"/*+



*/"
1c,SELECT COUNT(*) FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id AND mc.note NOT LIKE '%(as metro-goldwyn-mayer pictures)%' AND mc.note LIKE '%(co-production)%' JOIN title AS t ON t.production_year > 2010 AND t.id = mc.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it ON it.info = 'top 250 rank' AND it.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = mc.movie_id,"/*+
IndexOnlyScan(it)
NestLoop(mi_idx it)

*/"
1d,SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it ON it.info = 'bottom 10 rank' AND it.id = mi_idx.info_type_id JOIN title AS t ON t.production_year > 2000 AND t.id = mi_idx.movie_id JOIN movie_companies AS mc ON mc.movie_id = mi_idx.movie_id AND mc.note NOT LIKE '%(as metro-goldwyn-mayer pictures)%' JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id,"/*+



*/"
2a,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON cn.country_code = '[de]' AND cn.id = mc.company_id,"/*+



*/"
2b,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON cn.country_code = '[nl]' AND cn.id = mc.company_id,"/*+



*/"
2c,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN (SELECT movie_id FROM movie_companies AS mc JOIN company_name AS cn ON cn.country_code = '[sm]' AND cn.id = mc.company_id) AS t_mc ON t_mc.movie_id = mk.movie_id,"/*+
IndexOnlyScan(cn)
NestLoop(mc cn)

*/"
2d,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id,"/*+



*/"
3a,"SELECT COUNT(*) FROM movie_info AS mi JOIN title AS t ON t.production_year > 2005 AND t.id = mi.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'denish', 'norwegian', 'german') JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword LIKE '%sequel%' AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi.movie_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
3b,SELECT COUNT(*) FROM movie_info AS mi JOIN title AS t ON t.production_year > 2010 AND t.id = mi.movie_id AND mi.info IN ('bulgaria') JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword LIKE '%sequel%' AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi.movie_id,"/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
3c,"SELECT COUNT(*) FROM movie_info AS mi JOIN title AS t ON t.production_year > 1990 AND t.id = mi.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'denish', 'norwegian', 'german', 'usa', 'american') JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword LIKE '%sequel%' AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi.movie_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
4a,SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it ON it.info = 'rating' AND it.id = mi_idx.info_type_id AND mi_idx.info > '5.0' JOIN title AS t ON t.production_year > 2005 AND t.id = mi_idx.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword LIKE '%sequel%' AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi_idx.movie_id,"/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
4b,SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it ON it.info = 'rating' AND it.id = mi_idx.info_type_id AND mi_idx.info > '9.0' JOIN title AS t ON t.production_year > 2010 AND t.id = mi_idx.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword LIKE '%sequel%' AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi_idx.movie_id,"/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
4c,SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it ON it.info = 'rating' AND it.id = mi_idx.info_type_id AND mi_idx.info > '2.0' JOIN title AS t ON t.production_year > 1990 AND t.id = mi_idx.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword LIKE '%sequel%' AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi_idx.movie_id,"/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
5a,"SELECT COUNT(*) FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id AND mc.note LIKE '%(theatrical)%' AND mc.note LIKE '%(france)%' JOIN title AS t ON t.production_year > 2005 AND t.id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = mc.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'denish', 'norwegian', 'german') JOIN info_type AS it ON it.id = mi.info_type_id","/*+



*/"
5b,"SELECT COUNT(*) FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id AND mc.note LIKE '%(vhs)%' AND mc.note LIKE '%(usa)%' AND mc.note LIKE '%(1994)%' JOIN title AS t ON t.production_year > 2010 AND t.id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = mc.movie_id AND mi.info IN ('usa', 'america') JOIN info_type AS it ON it.id = mi.info_type_id","/*+



*/"
5c,"SELECT COUNT(*) FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id AND mc.note NOT LIKE '%(tv)%' AND mc.note LIKE '%(usa)%' JOIN title AS t ON t.production_year > 1990 AND t.id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = mc.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'denish', 'norwegian', 'german', 'usa', 'american') JOIN info_type AS it ON it.id = mi.info_type_id","/*+



*/"
6a,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'marvel-cinematic-universe' AND k.id = mk.keyword_id JOIN title AS t ON t.production_year > 2010 AND t.id = mk.movie_id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN name AS n ON n.name LIKE '%downey%robert%' AND n.id = ci.person_id) AS t_ci ON t_ci.movie_id = mk.movie_id","/*+
IndexOnlyScan(n)
NestLoop(ci n)

*/"
6b,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND k.id = mk.keyword_id JOIN title AS t ON t.production_year > 2014 AND t.id = mk.movie_id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN name AS n ON n.name LIKE '%downey%robert%' AND n.id = ci.person_id) AS t_ci ON t_ci.movie_id = mk.movie_id","/*+
IndexOnlyScan(n)
NestLoop(ci n)

*/"
6c,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'marvel-cinematic-universe' AND k.id = mk.keyword_id JOIN title AS t ON t.production_year > 2014 AND t.id = mk.movie_id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN name AS n ON n.name LIKE '%downey%robert%' AND n.id = ci.person_id) AS t_ci ON t_ci.movie_id = mk.movie_id","/*+
IndexOnlyScan(n)
NestLoop(ci n)

*/"
6d,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND k.id = mk.keyword_id JOIN title AS t ON t.production_year > 2000 AND t.id = mk.movie_id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN name AS n ON n.name LIKE '%downey%robert%' AND n.id = ci.person_id) AS t_ci ON t_ci.movie_id = mk.movie_id","/*+
IndexOnlyScan(n)
NestLoop(ci n)

*/"
6e,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'marvel-cinematic-universe' AND k.id = mk.keyword_id JOIN title AS t ON t.production_year > 2000 AND t.id = mk.movie_id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN name AS n ON n.name LIKE '%downey%robert%' AND n.id = ci.person_id) AS t_ci ON t_ci.movie_id = mk.movie_id","/*+
IndexOnlyScan(n)
NestLoop(ci n)

*/"
6f,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND k.id = mk.keyword_id JOIN title AS t ON t.production_year > 2000 AND t.id = mk.movie_id JOIN cast_info AS ci ON ci.movie_id = mk.movie_id JOIN name AS n ON n.id = ci.person_id","/*+



*/"
7a,"SELECT COUNT(*) FROM person_info AS pi JOIN info_type AS it ON it.info = 'mini biography' AND it.id = pi.info_type_id AND pi.note = 'volker boehm' JOIN name AS n ON n.name_pcode_cf BETWEEN 'a' AND 'f' AND (n.gender = 'm' OR n.gender = 'f' AND n.name LIKE 'b%') AND n.id = pi.person_id JOIN aka_name AS an ON an.person_id = pi.person_id AND an.name LIKE '%a%' JOIN cast_info AS ci ON ci.person_id = an.person_id JOIN title AS t ON t.production_year BETWEEN 1980 AND 1995 AND t.id = ci.movie_id JOIN (SELECT linked_movie_id, movie_id FROM movie_link AS ml JOIN link_type AS lt ON lt.link = 'features' AND lt.id = ml.link_type_id) AS t_ml ON t_ml.linked_movie_id = ci.movie_id","/*+
IndexOnlyScan(lt)
NestLoop(ml lt)

*/"
7b,"SELECT COUNT(*) FROM person_info AS pi JOIN info_type AS it ON it.info = 'mini biography' AND it.id = pi.info_type_id AND pi.note = 'volker boehm' JOIN name AS n ON n.name_pcode_cf LIKE 'd%' AND n.gender = 'm' AND n.id = pi.person_id JOIN aka_name AS an ON an.person_id = pi.person_id AND an.name LIKE '%a%' JOIN cast_info AS ci ON ci.person_id = an.person_id JOIN title AS t ON t.production_year BETWEEN 1980 AND 1984 AND t.id = ci.movie_id JOIN (SELECT linked_movie_id, movie_id FROM movie_link AS ml JOIN link_type AS lt ON lt.link = 'features' AND lt.id = ml.link_type_id) AS t_ml ON t_ml.linked_movie_id = ci.movie_id","/*+
IndexOnlyScan(lt)
NestLoop(ml lt)

*/"
7c,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link IN ('references', 'referenced in', 'features', 'featured in') AND lt.id = ml.link_type_id JOIN title AS t ON t.production_year BETWEEN 1980 AND 2010 AND ml.linked_movie_id = t.id JOIN cast_info AS ci ON ci.movie_id = ml.linked_movie_id JOIN aka_name AS an ON an.person_id = ci.person_id AND an.name IS NOT NULL AND (an.name LIKE '%a%' OR an.name LIKE 'a%') JOIN person_info AS pi ON pi.person_id = an.person_id AND pi.note IS NOT NULL JOIN info_type AS it ON it.info = 'mini biography' AND it.id = pi.info_type_id JOIN name AS n ON n.name_pcode_cf BETWEEN 'a' AND 'f' AND (n.gender = 'm' OR n.gender = 'f' AND n.name LIKE 'a%') AND n.id = pi.person_id","/*+



*/"
8a,SELECT COUNT(*) FROM movie_companies AS mc JOIN company_name AS cn ON cn.country_code = '[jp]' AND mc.company_id = cn.id AND mc.note LIKE '%(japan)%' AND mc.note NOT LIKE '%(usa)%' JOIN title AS t ON t.id = mc.movie_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id AND ci.note = '(voice: english version)' JOIN role_type AS rt ON rt.role = 'actress' AND ci.role_id = rt.id JOIN aka_name AS an1 ON an1.person_id = ci.person_id JOIN name AS n1 ON n1.name LIKE '%yo%' AND n1.name NOT LIKE '%yu%' AND an1.person_id = n1.id,"/*+



*/"
8b,SELECT COUNT(*) FROM movie_companies AS mc JOIN title AS t ON t.production_year BETWEEN 2006 AND 2007 AND (t.title LIKE 'one piece%' OR t.title LIKE 'dragon ball z%') AND t.id = mc.movie_id AND mc.note LIKE '%(japan)%' AND mc.note NOT LIKE '%(usa)%' AND (mc.note LIKE '%(2006)%' OR mc.note LIKE '%(2007)%') JOIN company_name AS cn ON cn.country_code = '[jp]' AND mc.company_id = cn.id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id AND ci.note = '(voice: english version)' JOIN role_type AS rt ON rt.role = 'actress' AND ci.role_id = rt.id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON n.name LIKE '%yo%' AND n.name NOT LIKE '%yu%' AND an.person_id = n.id,"/*+



*/"
8c,"SELECT COUNT(*) FROM aka_name AS a1 JOIN name AS n1 ON a1.person_id = n1.id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN role_type AS rt ON rt.role = 'writer' AND ci.role_id = rt.id JOIN title AS t ON ci.movie_id = t.id) AS t_ci ON t_ci.person_id = a1.person_id JOIN movie_companies AS mc ON mc.movie_id = t_ci.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id","/*+
IndexOnlyScan(rt)
IndexOnlyScan(t)
NestLoop(ci rt)
NestLoop(ci rt t)

*/"
8d,"SELECT COUNT(*) FROM aka_name AS an1 JOIN name AS n1 ON an1.person_id = n1.id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN role_type AS rt ON rt.role = 'costume designer' AND ci.role_id = rt.id JOIN title AS t ON ci.movie_id = t.id) AS t_ci ON t_ci.person_id = an1.person_id JOIN movie_companies AS mc ON mc.movie_id = t_ci.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id","/*+
IndexOnlyScan(rt)
IndexOnlyScan(t)
NestLoop(ci rt)
NestLoop(ci rt t)

*/"
9a,"SELECT COUNT(*) FROM aka_name AS an JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%ang%' AND an.person_id = n.id JOIN cast_info AS ci ON ci.person_id = an.person_id AND ci.note IN ('(voice)', '(voice: japanese version)', '(voice) (uncredited)', '(voice: english version)') JOIN role_type AS rt ON rt.role = 'actress' AND ci.role_id = rt.id JOIN title AS t ON t.production_year BETWEEN 2005 AND 2015 AND ci.movie_id = t.id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN movie_companies AS mc ON mc.movie_id = ci.movie_id AND mc.note IS NOT NULL AND (mc.note LIKE '%(usa)%' OR mc.note LIKE '%(worldwide)%') JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id","/*+



*/"
9b,SELECT COUNT(*) FROM aka_name AS an JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%angel%' AND an.person_id = n.id JOIN cast_info AS ci ON ci.person_id = an.person_id AND ci.note = '(voice)' JOIN role_type AS rt ON rt.role = 'actress' AND ci.role_id = rt.id JOIN title AS t ON t.production_year BETWEEN 2007 AND 2010 AND ci.movie_id = t.id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN movie_companies AS mc ON mc.movie_id = ci.movie_id AND mc.note LIKE '%(200%)%' AND (mc.note LIKE '%(usa)%' OR mc.note LIKE '%(worldwide)%') JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id,"/*+



*/"
9c,"SELECT COUNT(*) FROM aka_name AS an JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%an%' AND an.person_id = n.id JOIN cast_info AS ci ON ci.person_id = an.person_id AND ci.note IN ('(voice)', '(voice: japanese version)', '(voice) (uncredited)', '(voice: english version)') JOIN role_type AS rt ON rt.role = 'actress' AND ci.role_id = rt.id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN title AS t ON ci.movie_id = t.id JOIN movie_companies AS mc ON mc.movie_id = ci.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id","/*+



*/"
9d,"SELECT COUNT(*) FROM aka_name AS an JOIN name AS n ON n.gender = 'f' AND an.person_id = n.id JOIN cast_info AS ci ON ci.person_id = an.person_id AND ci.note IN ('(voice)', '(voice: japanese version)', '(voice) (uncredited)', '(voice: english version)') JOIN role_type AS rt ON rt.role = 'actress' AND ci.role_id = rt.id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN title AS t ON ci.movie_id = t.id JOIN movie_companies AS mc ON mc.movie_id = ci.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id","/*+



*/"
10a,SELECT COUNT(*) FROM cast_info AS ci JOIN role_type AS rt ON rt.role = 'actor' AND rt.id = ci.role_id AND ci.note LIKE '%(voice)%' AND ci.note LIKE '%(uncredited)%' JOIN title AS t ON t.production_year > 2005 AND t.id = ci.movie_id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN movie_companies AS mc ON mc.movie_id = ci.movie_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[ru]' AND cn.id = mc.company_id,"/*+



*/"
10b,SELECT COUNT(*) FROM cast_info AS ci JOIN role_type AS rt ON rt.role = 'actor' AND rt.id = ci.role_id AND ci.note LIKE '%(producer)%' JOIN title AS t ON t.production_year > 2010 AND t.id = ci.movie_id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN movie_companies AS mc ON mc.movie_id = ci.movie_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[ru]' AND cn.id = mc.company_id,"/*+



*/"
10c,SELECT COUNT(*) FROM cast_info AS ci JOIN role_type AS rt ON rt.id = ci.role_id AND ci.note LIKE '%(producer)%' JOIN title AS t ON t.production_year > 1990 AND t.id = ci.movie_id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN movie_companies AS mc ON mc.movie_id = ci.movie_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id,"/*+



*/"
11a,SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link LIKE '%follow%' AND lt.id = ml.link_type_id JOIN title AS t ON t.production_year BETWEEN 1950 AND 2000 AND ml.movie_id = t.id JOIN movie_companies AS mc ON mc.movie_id = ml.movie_id AND mc.note IS NULL JOIN company_type AS ct ON ct.kind = 'production companies' AND mc.company_type_id = ct.id JOIN company_name AS cn ON cn.country_code <> '[pl]' AND (cn.name LIKE '%film%' OR cn.name LIKE '%warner%') AND mc.company_id = cn.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'sequel' AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = mc.movie_id,"/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
11b,"SELECT COUNT(*) FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND mc.company_type_id = ct.id AND mc.note IS NULL JOIN title AS t ON t.production_year = 1998 AND t.title LIKE '%money%' AND t.id = mc.movie_id JOIN company_name AS cn ON cn.country_code <> '[pl]' AND (cn.name LIKE '%film%' OR cn.name LIKE '%warner%') AND mc.company_id = cn.id JOIN (SELECT linked_movie_id, movie_id FROM movie_link AS ml JOIN link_type AS lt ON lt.link LIKE '%follows%' AND lt.id = ml.link_type_id) AS t_ml ON t_ml.movie_id = mc.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'sequel' AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = t_ml.movie_id","/*+
IndexOnlyScan(lt)
IndexOnlyScan(k)
NestLoop(ml lt)
NestLoop(mk k)

*/"
11c,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.id = ml.link_type_id JOIN title AS t ON t.production_year > 1950 AND ml.movie_id = t.id JOIN movie_companies AS mc ON mc.movie_id = ml.movie_id AND mc.note IS NOT NULL JOIN company_type AS ct ON ct.kind <> 'production companies' AND ct.kind IS NOT NULL AND mc.company_type_id = ct.id JOIN company_name AS cn ON cn.country_code <> '[pl]' AND (cn.name LIKE '20th century fox%' OR cn.name LIKE 'twentieth century fox%') AND mc.company_id = cn.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('sequel', 'revenge', 'based-on-novel') AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = mc.movie_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
11d,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.id = ml.link_type_id JOIN title AS t ON t.production_year > 1950 AND ml.movie_id = t.id JOIN movie_companies AS mc ON mc.movie_id = ml.movie_id AND mc.note IS NOT NULL JOIN company_type AS ct ON ct.kind <> 'production companies' AND ct.kind IS NOT NULL AND mc.company_type_id = ct.id JOIN company_name AS cn ON cn.country_code <> '[pl]' AND mc.company_id = cn.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('sequel', 'revenge', 'based-on-novel') AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = mc.movie_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
12a,"SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND mi_idx.info_type_id = it2.id AND mi_idx.info > '8.0' JOIN title AS t ON t.production_year BETWEEN 2005 AND 2008 AND t.id = mi_idx.movie_id JOIN movie_info AS mi ON mi.movie_id = mi_idx.movie_id AND mi.info IN ('drama', 'horror') JOIN info_type AS it1 ON it1.info = 'genres' AND mi.info_type_id = it1.id JOIN (SELECT movie_id FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id) AS t_mc ON t_mc.movie_id = mi.movie_id","/*+
IndexOnlyScan(ct)
IndexOnlyScan(cn)
NestLoop(mc ct)
NestLoop(mc ct cn)

*/"
12b,SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'bottom 10 rank' AND mi_idx.info_type_id = it2.id JOIN title AS t ON t.production_year > 2000 AND (t.title LIKE 'birdemic%' OR t.title LIKE '%movie%') AND t.id = mi_idx.movie_id JOIN movie_companies AS mc ON mc.movie_id = mi_idx.movie_id JOIN company_type AS ct ON ct.kind IS NOT NULL AND (ct.kind = 'production companies' OR ct.kind = 'distributors') AND ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN (SELECT movie_id FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'budget' AND mi.info_type_id = it1.id) AS t_mi ON t_mi.movie_id = mc.movie_id,"/*+
IndexOnlyScan(it1)
NestLoop(mi it1)

*/"
12c,"SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND mi_idx.info_type_id = it2.id AND mi_idx.info > '7.0' JOIN title AS t ON t.production_year BETWEEN 2000 AND 2010 AND t.id = mi_idx.movie_id JOIN movie_info AS mi ON mi.movie_id = mi_idx.movie_id AND mi.info IN ('drama', 'horror', 'western', 'family') JOIN info_type AS it1 ON it1.info = 'genres' AND mi.info_type_id = it1.id JOIN (SELECT movie_id FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id) AS t_mc ON t_mc.movie_id = mi.movie_id","/*+
IndexOnlyScan(ct)
IndexOnlyScan(cn)
NestLoop(mc ct)
NestLoop(mc ct cn)

*/"
13a,SELECT COUNT(*) FROM movie_info_idx AS miidx JOIN info_type AS it ON it.info = 'rating' AND it.id = miidx.info_type_id JOIN title AS t ON miidx.movie_id = t.id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[de]' AND cn.id = mc.company_id) AS t_mc ON t_mc.movie_id = miidx.movie_id JOIN (SELECT movie_id FROM movie_info AS mi JOIN info_type AS it2 ON it2.info = 'release dates' AND it2.id = mi.info_type_id) AS t_mi ON t_mi.movie_id = t_mc.movie_id,"/*+
IndexOnlyScan(ct)
IndexOnlyScan(cn)
IndexOnlyScan(it2)
NestLoop(mc ct)
NestLoop(mc ct cn)
NestLoop(mi it2)

*/"
13b,SELECT COUNT(*) FROM movie_info_idx AS miidx JOIN info_type AS it ON it.info = 'rating' AND it.id = miidx.info_type_id JOIN title AS t ON t.title <> '' AND (t.title LIKE '%champion%' OR t.title LIKE '%loser%') AND miidx.movie_id = t.id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id) AS t_mc ON t_mc.movie_id = miidx.movie_id JOIN (SELECT movie_id FROM movie_info AS mi JOIN info_type AS it2 ON it2.info = 'release dates' AND it2.id = mi.info_type_id) AS t_mi ON t_mi.movie_id = t_mc.movie_id,"/*+
IndexOnlyScan(ct)
IndexOnlyScan(cn)
IndexOnlyScan(it2)
NestLoop(mc ct)
NestLoop(mc ct cn)
NestLoop(mi it2)

*/"
13c,SELECT COUNT(*) FROM movie_info_idx AS miidx JOIN info_type AS it ON it.info = 'rating' AND it.id = miidx.info_type_id JOIN title AS t ON t.title <> '' AND (t.title LIKE 'champion%' OR t.title LIKE 'loser%') AND miidx.movie_id = t.id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id) AS t_mc ON t_mc.movie_id = miidx.movie_id JOIN (SELECT movie_id FROM movie_info AS mi JOIN info_type AS it2 ON it2.info = 'release dates' AND it2.id = mi.info_type_id) AS t_mi ON t_mi.movie_id = t_mc.movie_id,"/*+
IndexOnlyScan(ct)
IndexOnlyScan(cn)
IndexOnlyScan(it2)
NestLoop(mc ct)
NestLoop(mc ct cn)
NestLoop(mi it2)

*/"
13d,SELECT COUNT(*) FROM movie_info_idx AS miidx JOIN info_type AS it ON it.info = 'rating' AND it.id = miidx.info_type_id JOIN title AS t ON miidx.movie_id = t.id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_companies AS mc JOIN company_type AS ct ON ct.kind = 'production companies' AND ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id) AS t_mc ON t_mc.movie_id = miidx.movie_id JOIN (SELECT movie_id FROM movie_info AS mi JOIN info_type AS it2 ON it2.info = 'release dates' AND it2.id = mi.info_type_id) AS t_mi ON t_mi.movie_id = t_mc.movie_id,"/*+
IndexOnlyScan(ct)
IndexOnlyScan(cn)
IndexOnlyScan(it2)
NestLoop(mc ct)
NestLoop(mc ct cn)
NestLoop(mi it2)

*/"
14a,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND k.id = mk.keyword_id JOIN title AS t ON t.production_year > 2010 AND t.id = mk.movie_id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id AND mi_idx.info < '8.5') AS t_mi_idx ON t_mi_idx.movie_id = mk.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mi_idx.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'denish', 'norwegian', 'german', 'usa', 'american') JOIN info_type AS it1 ON it1.info = 'countries' AND it1.id = mi.info_type_id","/*+
IndexOnlyScan(it2)
NestLoop(mi_idx it2)

*/"
14b,"SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id AND mi_idx.info > '6.0' JOIN title AS t ON t.production_year > 2010 AND (t.title LIKE '%murder%' OR t.title LIKE '%murder%' OR t.title LIKE '%mord%') AND t.id = mi_idx.movie_id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'murder-in-title') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi_idx.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'denish', 'norwegian', 'german', 'usa', 'american') JOIN info_type AS it1 ON it1.info = 'countries' AND it1.id = mi.info_type_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
14c,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IS NOT NULL AND k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND k.id = mk.keyword_id JOIN title AS t ON t.production_year > 2005 AND t.id = mk.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie', 'episode') AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id AND mi_idx.info < '8.5') AS t_mi_idx ON t_mi_idx.movie_id = mk.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mi_idx.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'danish', 'norwegian', 'german', 'usa', 'american') JOIN info_type AS it1 ON it1.info = 'countries' AND it1.id = mi.info_type_id","/*+
IndexOnlyScan(it2)
NestLoop(mi_idx it2)

*/"
15a,SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'release dates' AND it1.id = mi.info_type_id AND mi.note LIKE '%internet%' AND mi.info LIKE 'usa:% 200%' JOIN title AS t ON t.production_year > 2000 AND t.id = mi.movie_id JOIN aka_title AS at ON at.movie_id = mi.movie_id JOIN movie_companies AS mc ON mc.movie_id = at.movie_id AND mc.note LIKE '%(200%)%' AND mc.note LIKE '%(worldwide)%' JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN movie_keyword AS mk ON mk.movie_id = mc.movie_id JOIN keyword AS k ON k.id = mk.keyword_id,"/*+



*/"
15b,SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'release dates' AND it1.id = mi.info_type_id AND mi.note LIKE '%internet%' AND mi.info LIKE 'usa:% 200%' JOIN title AS t ON t.production_year BETWEEN 2005 AND 2010 AND t.id = mi.movie_id JOIN aka_title AS at ON at.movie_id = mi.movie_id JOIN movie_companies AS mc ON mc.movie_id = at.movie_id AND mc.note LIKE '%(200%)%' AND mc.note LIKE '%(worldwide)%' JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.name = 'youtube' AND cn.id = mc.company_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN movie_keyword AS mk ON mk.movie_id = mc.movie_id JOIN keyword AS k ON k.id = mk.keyword_id,"/*+



*/"
15c,SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'release dates' AND it1.id = mi.info_type_id AND mi.note LIKE '%internet%' AND mi.info IS NOT NULL AND (mi.info LIKE 'usa:% 199%' OR mi.info LIKE 'usa:% 200%') JOIN title AS t ON t.production_year > 1990 AND t.id = mi.movie_id JOIN aka_title AS at ON at.movie_id = mi.movie_id JOIN movie_companies AS mc ON mc.movie_id = at.movie_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN movie_keyword AS mk ON mk.movie_id = mc.movie_id JOIN keyword AS k ON k.id = mk.keyword_id,"/*+



*/"
15d,SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'release dates' AND it1.id = mi.info_type_id AND mi.note LIKE '%internet%' JOIN title AS t ON t.production_year > 1990 AND t.id = mi.movie_id JOIN aka_title AS at ON at.movie_id = mi.movie_id JOIN movie_companies AS mc ON mc.movie_id = at.movie_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN movie_keyword AS mk ON mk.movie_id = mc.movie_id JOIN keyword AS k ON k.id = mk.keyword_id,"/*+



*/"
16a,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.episode_nr >= 50 AND t.episode_nr < 100 AND t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON an.person_id = n.id,"/*+



*/"
16b,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON an.person_id = n.id,"/*+



*/"
16c,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.episode_nr < 100 AND t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON an.person_id = n.id,"/*+



*/"
16d,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.episode_nr >= 5 AND t.episode_nr < 100 AND t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON an.person_id = n.id,"/*+



*/"
17a,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN name AS n ON n.name LIKE 'b%' AND n.id = ci.person_id,"/*+



*/"
17b,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN name AS n ON n.name LIKE 'z%' AND n.id = ci.person_id) AS t_ci ON t_ci.movie_id = mc.movie_id","/*+
IndexOnlyScan(n)
NestLoop(ci n)

*/"
17c,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN name AS n ON n.name LIKE 'x%' AND n.id = ci.person_id) AS t_ci ON t_ci.movie_id = mc.movie_id","/*+
IndexOnlyScan(n)
NestLoop(ci n)

*/"
17d,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN name AS n ON n.name LIKE '%bert%' AND n.id = ci.person_id) AS t_ci ON t_ci.movie_id = mc.movie_id","/*+
IndexOnlyScan(n)
NestLoop(ci n)

*/"
17e,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND mc.company_id = cn.id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN name AS n ON n.id = ci.person_id,"/*+



*/"
17f,SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id JOIN title AS t ON t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN name AS n ON n.name LIKE '%b%' AND n.id = ci.person_id,"/*+



*/"
18a,"SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id JOIN title AS t ON t.id = mi_idx.movie_id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN name AS n ON n.gender = 'm' AND n.name LIKE '%tim%' AND n.id = ci.person_id AND ci.note IN ('(producer)', '(executive producer)')) AS t_ci ON t_ci.movie_id = mi_idx.movie_id JOIN (SELECT movie_id FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'budget' AND it1.id = mi.info_type_id) AS t_mi ON t_mi.movie_id = t_ci.movie_id","/*+
IndexOnlyScan(n)
IndexOnlyScan(it1)
NestLoop(ci n)
NestLoop(mi it1)

*/"
18b,"SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id AND mi.info IN ('horror', 'thriller') AND mi.note IS NULL JOIN title AS t ON t.production_year BETWEEN 2008 AND 2014 AND t.id = mi.movie_id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = mi.movie_id AND mi_idx.info > '8.0' JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id JOIN cast_info AS ci ON ci.movie_id = mi_idx.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.gender IS NOT NULL AND n.gender = 'f' AND n.id = ci.person_id","/*+



*/"
18c,"SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id AND mi.info IN ('horror', 'action', 'sci-fi', 'thriller', 'crime', 'war') JOIN title AS t ON t.id = mi.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = mi.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mi_idx.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.gender = 'm' AND n.id = ci.person_id","/*+
IndexOnlyScan(it2)
NestLoop(mi_idx it2)

*/"
19a,"SELECT COUNT(*) FROM aka_name AS an JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%ang%' AND n.id = an.person_id JOIN cast_info AS ci ON ci.person_id = an.person_id AND ci.note IN ('(voice)', '(voice: japanese version)', '(voice) (uncredited)', '(voice: english version)') JOIN role_type AS rt ON rt.role = 'actress' AND rt.id = ci.role_id JOIN title AS t ON t.production_year BETWEEN 2005 AND 2009 AND t.id = ci.movie_id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN movie_companies AS mc ON mc.movie_id = ci.movie_id AND mc.note IS NOT NULL AND (mc.note LIKE '%(usa)%' OR mc.note LIKE '%(worldwide)%') JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN movie_info AS mi ON mi.movie_id = mc.movie_id AND mi.info IS NOT NULL AND (mi.info LIKE 'japan:%200%' OR mi.info LIKE 'usa:%200%') JOIN info_type AS it ON it.info = 'release dates' AND it.id = mi.info_type_id","/*+



*/"
19b,SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it ON it.info = 'release dates' AND it.id = mi.info_type_id AND mi.info IS NOT NULL AND (mi.info LIKE 'japan:%2007%' OR mi.info LIKE 'usa:%2008%') JOIN title AS t ON t.production_year BETWEEN 2007 AND 2008 AND t.title LIKE '%kung%fu%panda%' AND t.id = mi.movie_id JOIN movie_companies AS mc ON mc.movie_id = mi.movie_id AND mc.note LIKE '%(200%)%' AND (mc.note LIKE '%(usa)%' OR mc.note LIKE '%(worldwide)%') JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id AND ci.note = '(voice)' JOIN role_type AS rt ON rt.role = 'actress' AND rt.id = ci.role_id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN (SELECT person_id FROM aka_name AS an JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%angel%' AND n.id = an.person_id) AS t_an ON t_an.person_id = ci.person_id,"/*+
IndexOnlyScan(n)
NestLoop(an n)

*/"
19c,"SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it ON it.info = 'release dates' AND it.id = mi.info_type_id AND mi.info IS NOT NULL AND (mi.info LIKE 'japan:%200%' OR mi.info LIKE 'usa:%200%') JOIN title AS t ON t.production_year > 2000 AND t.id = mi.movie_id JOIN movie_companies AS mc ON mc.movie_id = mi.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id AND ci.note IN ('(voice)', '(voice: japanese version)', '(voice) (uncredited)', '(voice: english version)') JOIN role_type AS rt ON rt.role = 'actress' AND rt.id = ci.role_id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%an%' AND n.id = an.person_id","/*+



*/"
19d,"SELECT COUNT(*) FROM aka_name AS an JOIN name AS n ON n.gender = 'f' AND n.id = an.person_id JOIN cast_info AS ci ON ci.person_id = an.person_id AND ci.note IN ('(voice)', '(voice: japanese version)', '(voice) (uncredited)', '(voice: english version)') JOIN role_type AS rt ON rt.role = 'actress' AND rt.id = ci.role_id JOIN title AS t ON t.production_year > 2000 AND t.id = ci.movie_id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN movie_companies AS mc ON mc.movie_id = ci.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN (SELECT movie_id FROM movie_info AS mi JOIN info_type AS it ON it.info = 'release dates' AND it.id = mi.info_type_id) AS t_mi ON t_mi.movie_id = mc.movie_id","/*+
IndexOnlyScan(it)
NestLoop(mi it)

*/"
20a,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind LIKE '%complete%' AND cct2.id = cc.status_id JOIN title AS t ON t.production_year > 1950 AND t.id = cc.movie_id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = cc.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id JOIN char_name AS chn ON chn.name NOT LIKE '%sherlock%' AND (chn.name LIKE '%tony%stark%' OR chn.name LIKE '%iron%man%') AND chn.id = ci.person_role_id JOIN name AS n ON n.id = ci.person_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
20b,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind LIKE '%complete%' AND cct2.id = cc.status_id JOIN title AS t ON t.production_year > 2000 AND t.id = cc.movie_id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = cc.movie_id JOIN (SELECT person_id, movie_id FROM cast_info AS ci JOIN name AS n ON n.name LIKE '%downey%robert%' AND n.id = ci.person_id JOIN char_name AS chn ON chn.name NOT LIKE '%sherlock%' AND (chn.name LIKE '%tony%stark%' OR chn.name LIKE '%iron%man%') AND chn.id = ci.person_role_id) AS t_ci ON t_ci.movie_id = t_mk.movie_id","/*+
IndexOnlyScan(k)
IndexOnlyScan(n)
IndexOnlyScan(chn)
NestLoop(mk k)
NestLoop(ci n)
NestLoop(ci n chn)

*/"
20c,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind LIKE '%complete%' AND cct2.id = cc.status_id JOIN title AS t ON t.production_year > 2000 AND t.id = cc.movie_id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = cc.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id JOIN char_name AS chn ON chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%man%') AND chn.id = ci.person_role_id JOIN name AS n ON n.id = ci.person_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
21a,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link LIKE '%follow%' AND lt.id = ml.link_type_id JOIN title AS t ON t.production_year BETWEEN 1950 AND 2000 AND ml.movie_id = t.id JOIN movie_companies AS mc ON mc.movie_id = ml.movie_id AND mc.note IS NULL JOIN company_type AS ct ON ct.kind = 'production companies' AND mc.company_type_id = ct.id JOIN company_name AS cn ON cn.country_code <> '[pl]' AND (cn.name LIKE '%film%' OR cn.name LIKE '%warner%') AND mc.company_id = cn.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'sequel' AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'denish', 'norwegian', 'german')","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
21b,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link LIKE '%follow%' AND lt.id = ml.link_type_id JOIN title AS t ON t.production_year BETWEEN 2000 AND 2010 AND ml.movie_id = t.id JOIN movie_companies AS mc ON mc.movie_id = ml.movie_id AND mc.note IS NULL JOIN company_type AS ct ON ct.kind = 'production companies' AND mc.company_type_id = ct.id JOIN company_name AS cn ON cn.country_code <> '[pl]' AND (cn.name LIKE '%film%' OR cn.name LIKE '%warner%') AND mc.company_id = cn.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'sequel' AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('germany', 'german')","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
21c,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link LIKE '%follow%' AND lt.id = ml.link_type_id JOIN title AS t ON t.production_year BETWEEN 1950 AND 2010 AND ml.movie_id = t.id JOIN movie_companies AS mc ON mc.movie_id = ml.movie_id AND mc.note IS NULL JOIN company_type AS ct ON ct.kind = 'production companies' AND mc.company_type_id = ct.id JOIN company_name AS cn ON cn.country_code <> '[pl]' AND (cn.name LIKE '%film%' OR cn.name LIKE '%warner%') AND mc.company_id = cn.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'sequel' AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'denish', 'norwegian', 'german', 'english')","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
22a,"SELECT COUNT(*) FROM movie_companies AS mc JOIN company_type AS ct ON ct.id = mc.company_type_id AND mc.note NOT LIKE '%(usa)%' AND mc.note LIKE '%(200%)%' JOIN company_name AS cn ON cn.country_code <> '[us]' AND cn.id = mc.company_id JOIN title AS t ON t.production_year > 2008 AND t.id = mc.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie', 'episode') AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id AND mi_idx.info < '7.0') AS t_mi_idx ON t_mi_idx.movie_id = mc.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = t_mi_idx.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('germany', 'german', 'usa', 'american') JOIN info_type AS it1 ON it1.info = 'countries' AND it1.id = mi.info_type_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
22b,"SELECT COUNT(*) FROM movie_companies AS mc JOIN company_type AS ct ON ct.id = mc.company_type_id AND mc.note NOT LIKE '%(usa)%' AND mc.note LIKE '%(200%)%' JOIN company_name AS cn ON cn.country_code <> '[us]' AND cn.id = mc.company_id JOIN title AS t ON t.production_year > 2009 AND t.id = mc.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie', 'episode') AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id AND mi_idx.info < '7.0') AS t_mi_idx ON t_mi_idx.movie_id = mc.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = t_mi_idx.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('germany', 'german', 'usa', 'american') JOIN info_type AS it1 ON it1.info = 'countries' AND it1.id = mi.info_type_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
22c,"SELECT COUNT(*) FROM movie_companies AS mc JOIN company_type AS ct ON ct.id = mc.company_type_id AND mc.note NOT LIKE '%(usa)%' AND mc.note LIKE '%(200%)%' JOIN company_name AS cn ON cn.country_code <> '[us]' AND cn.id = mc.company_id JOIN title AS t ON t.production_year > 2005 AND t.id = mc.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie', 'episode') AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id AND mi_idx.info < '8.5') AS t_mi_idx ON t_mi_idx.movie_id = mc.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = t_mi_idx.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'danish', 'norwegian', 'german', 'usa', 'american') JOIN info_type AS it1 ON it1.info = 'countries' AND it1.id = mi.info_type_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
22d,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND k.id = mk.keyword_id JOIN title AS t ON t.production_year > 2005 AND t.id = mk.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie', 'episode') AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id AND mi_idx.info < '8.5') AS t_mi_idx ON t_mi_idx.movie_id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = t_mi_idx.movie_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code <> '[us]' AND cn.id = mc.company_id JOIN movie_info AS mi ON mi.movie_id = mc.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'danish', 'norwegian', 'german', 'usa', 'american') JOIN info_type AS it1 ON it1.info = 'countries' AND it1.id = mi.info_type_id","/*+
IndexOnlyScan(it2)
NestLoop(mi_idx it2)

*/"
23a,SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'release dates' AND it1.id = mi.info_type_id AND mi.note LIKE '%internet%' AND mi.info IS NOT NULL AND (mi.info LIKE 'usa:% 199%' OR mi.info LIKE 'usa:% 200%') JOIN title AS t ON t.production_year > 2000 AND t.id = mi.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie') AND kt.id = t.kind_id JOIN (SELECT movie_id FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'complete+verified' AND cct1.id = cc.status_id) AS t_cc ON t_cc.movie_id = mi.movie_id JOIN movie_companies AS mc ON mc.movie_id = t_cc.movie_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN movie_keyword AS mk ON mk.movie_id = mc.movie_id JOIN keyword AS k ON k.id = mk.keyword_id,"/*+
IndexOnlyScan(cct1)
NestLoop(cc cct1)

*/"
23b,"SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'release dates' AND it1.id = mi.info_type_id AND mi.note LIKE '%internet%' AND mi.info LIKE 'usa:% 200%' JOIN title AS t ON t.production_year > 2000 AND t.id = mi.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie') AND kt.id = t.kind_id JOIN (SELECT movie_id FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'complete+verified' AND cct1.id = cc.status_id) AS t_cc ON t_cc.movie_id = mi.movie_id JOIN movie_companies AS mc ON mc.movie_id = t_cc.movie_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('nerd', 'loner', 'alienation', 'dignity') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mc.movie_id","/*+
IndexOnlyScan(cct1)
IndexOnlyScan(k)
NestLoop(cc cct1)
NestLoop(mk k)

*/"
23c,"SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'release dates' AND it1.id = mi.info_type_id AND mi.note LIKE '%internet%' AND mi.info IS NOT NULL AND (mi.info LIKE 'usa:% 199%' OR mi.info LIKE 'usa:% 200%') JOIN title AS t ON t.production_year > 1990 AND t.id = mi.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie', 'tv movie', 'video movie', 'video game') AND kt.id = t.kind_id JOIN (SELECT movie_id FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'complete+verified' AND cct1.id = cc.status_id) AS t_cc ON t_cc.movie_id = mi.movie_id JOIN movie_companies AS mc ON mc.movie_id = t_cc.movie_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN movie_keyword AS mk ON mk.movie_id = mc.movie_id JOIN keyword AS k ON k.id = mk.keyword_id","/*+
IndexOnlyScan(cct1)
NestLoop(cc cct1)

*/"
24a,"SELECT COUNT(*) FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('hero', 'martial-arts', 'hand-to-hand-combat') AND k.id = mk.keyword_id JOIN title AS t ON t.production_year > 2010 AND t.id = mk.movie_id JOIN movie_companies AS mc ON mc.movie_id = mk.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id AND ci.note IN ('(voice)', '(voice: japanese version)', '(voice) (uncredited)', '(voice: english version)') JOIN role_type AS rt ON rt.role = 'actress' AND rt.id = ci.role_id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%an%' AND n.id = an.person_id JOIN movie_info AS mi ON mi.movie_id = ci.movie_id AND mi.info IS NOT NULL AND (mi.info LIKE 'japan:%201%' OR mi.info LIKE 'usa:%201%') JOIN info_type AS it ON it.info = 'release dates' AND it.id = mi.info_type_id","/*+



*/"
24b,"SELECT COUNT(*) FROM movie_companies AS mc JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.name = 'dreamworks animation' AND cn.id = mc.company_id JOIN title AS t ON t.production_year > 2010 AND t.title LIKE 'kung fu panda%' AND t.id = mc.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('hero', 'martial-arts', 'hand-to-hand-combat', 'computer-animated-movie') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(voice)', '(voice: japanese version)', '(voice) (uncredited)', '(voice: english version)') JOIN role_type AS rt ON rt.role = 'actress' AND rt.id = ci.role_id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%an%' AND n.id = an.person_id JOIN movie_info AS mi ON mi.movie_id = ci.movie_id AND mi.info IS NOT NULL AND (mi.info LIKE 'japan:%201%' OR mi.info LIKE 'usa:%201%') JOIN info_type AS it ON it.info = 'release dates' AND it.id = mi.info_type_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
25a,"SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id AND mi.info = 'horror' JOIN title AS t ON t.id = mi.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = mi.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'blood', 'gore', 'death', 'female-nudity') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = t_mi_idx.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.gender = 'm' AND n.id = ci.person_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
25b,"SELECT COUNT(*) FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id JOIN title AS t ON t.production_year > 2010 AND t.title LIKE 'vampire%' AND t.id = mi_idx.movie_id JOIN movie_info AS mi ON mi.movie_id = mi_idx.movie_id AND mi.info = 'horror' JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'blood', 'gore', 'death', 'female-nudity') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.gender = 'm' AND n.id = ci.person_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
25c,"SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id AND mi.info IN ('horror', 'action', 'sci-fi', 'thriller', 'crime', 'war') JOIN title AS t ON t.id = mi.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = mi.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = t_mi_idx.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.gender = 'm' AND n.id = ci.person_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
26a,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind LIKE '%complete%' AND cct2.id = cc.status_id JOIN title AS t ON t.production_year > 2000 AND t.id = cc.movie_id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = cc.movie_id AND mi_idx.info > '7.0' JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi_idx.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id JOIN char_name AS chn ON chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%man%') AND chn.id = ci.person_role_id JOIN name AS n ON n.id = ci.person_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
26b,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind LIKE '%complete%' AND cct2.id = cc.status_id JOIN title AS t ON t.production_year > 2005 AND t.id = cc.movie_id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = cc.movie_id AND mi_idx.info > '8.0' JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'fight') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi_idx.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id JOIN char_name AS chn ON chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%man%') AND chn.id = ci.person_role_id JOIN name AS n ON n.id = ci.person_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
26c,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind LIKE '%complete%' AND cct2.id = cc.status_id JOIN title AS t ON t.production_year > 2000 AND t.id = cc.movie_id JOIN kind_type AS kt ON kt.kind = 'movie' AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = cc.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = t_mi_idx.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id JOIN char_name AS chn ON chn.name IS NOT NULL AND (chn.name LIKE '%man%' OR chn.name LIKE '%man%') AND chn.id = ci.person_role_id JOIN name AS n ON n.id = ci.person_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
27a,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link LIKE '%follow%' AND lt.id = ml.link_type_id JOIN title AS t ON t.production_year BETWEEN 1950 AND 2000 AND ml.movie_id = t.id JOIN (SELECT movie_id FROM complete_cast AS cc JOIN comp_cast_type AS cct2 ON cct2.kind = 'complete' AND cct2.id = cc.status_id JOIN comp_cast_type AS cct1 ON cct1.kind IN ('cast', 'crew') AND cct1.id = cc.subject_id) AS t_cc ON t_cc.movie_id = ml.movie_id JOIN movie_companies AS mc ON mc.movie_id = t_cc.movie_id AND mc.note IS NULL JOIN company_type AS ct ON ct.kind = 'production companies' AND mc.company_type_id = ct.id JOIN company_name AS cn ON cn.country_code <> '[pl]' AND (cn.name LIKE '%film%' OR cn.name LIKE '%warner%') AND mc.company_id = cn.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'sequel' AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('sweden', 'germany', 'swedish', 'german')","/*+
IndexOnlyScan(cct2)
IndexOnlyScan(cct1)
IndexOnlyScan(k)
NestLoop(cc cct2)
NestLoop(cc cct2 cct1)
NestLoop(mk k)

*/"
27b,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link LIKE '%follow%' AND lt.id = ml.link_type_id JOIN title AS t ON t.production_year = 1998 AND ml.movie_id = t.id JOIN (SELECT movie_id FROM complete_cast AS cc JOIN comp_cast_type AS cct2 ON cct2.kind = 'complete' AND cct2.id = cc.status_id JOIN comp_cast_type AS cct1 ON cct1.kind IN ('cast', 'crew') AND cct1.id = cc.subject_id) AS t_cc ON t_cc.movie_id = ml.movie_id JOIN movie_companies AS mc ON mc.movie_id = t_cc.movie_id AND mc.note IS NULL JOIN company_type AS ct ON ct.kind = 'production companies' AND mc.company_type_id = ct.id JOIN company_name AS cn ON cn.country_code <> '[pl]' AND (cn.name LIKE '%film%' OR cn.name LIKE '%warner%') AND mc.company_id = cn.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'sequel' AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('sweden', 'germany', 'swedish', 'german')","/*+
IndexOnlyScan(cct2)
IndexOnlyScan(cct1)
IndexOnlyScan(k)
NestLoop(cc cct2)
NestLoop(cc cct2 cct1)
NestLoop(mk k)

*/"
27c,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link LIKE '%follow%' AND lt.id = ml.link_type_id JOIN title AS t ON t.production_year BETWEEN 1950 AND 2010 AND ml.movie_id = t.id JOIN (SELECT movie_id FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind LIKE 'complete%' AND cct2.id = cc.status_id) AS t_cc ON t_cc.movie_id = ml.movie_id JOIN movie_companies AS mc ON mc.movie_id = t_cc.movie_id AND mc.note IS NULL JOIN company_type AS ct ON ct.kind = 'production companies' AND mc.company_type_id = ct.id JOIN company_name AS cn ON cn.country_code <> '[pl]' AND (cn.name LIKE '%film%' OR cn.name LIKE '%warner%') AND mc.company_id = cn.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'sequel' AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'denish', 'norwegian', 'german', 'english')","/*+
IndexOnlyScan(cct1)
IndexOnlyScan(cct2)
IndexOnlyScan(k)
NestLoop(cc cct1)
NestLoop(cc cct1 cct2)
NestLoop(mk k)

*/"
28a,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'crew' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind <> 'complete+verified' AND cct2.id = cc.status_id JOIN title AS t ON t.production_year > 2000 AND t.id = cc.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie', 'episode') AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id AND mi_idx.info < '8.5') AS t_mi_idx ON t_mi_idx.movie_id = cc.movie_id JOIN movie_companies AS mc ON mc.movie_id = t_mi_idx.movie_id AND mc.note NOT LIKE '%(usa)%' AND mc.note LIKE '%(200%)%' JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code <> '[us]' AND cn.id = mc.company_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'danish', 'norwegian', 'german', 'usa', 'american') JOIN info_type AS it1 ON it1.info = 'countries' AND it1.id = mi.info_type_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
28b,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'crew' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind <> 'complete+verified' AND cct2.id = cc.status_id JOIN title AS t ON t.production_year > 2005 AND t.id = cc.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie', 'episode') AND kt.id = t.kind_id JOIN movie_info AS mi ON mi.movie_id = cc.movie_id AND mi.info IN ('sweden', 'germany', 'swedish', 'german') JOIN info_type AS it1 ON it1.info = 'countries' AND it1.id = mi.info_type_id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = mi.movie_id AND mi_idx.info > '6.5' JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id JOIN movie_companies AS mc ON mc.movie_id = mi_idx.movie_id AND mc.note NOT LIKE '%(usa)%' AND mc.note LIKE '%(200%)%' JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code <> '[us]' AND cn.id = mc.company_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mc.movie_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
28c,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind = 'complete' AND cct2.id = cc.status_id JOIN title AS t ON t.production_year > 2005 AND t.id = cc.movie_id JOIN kind_type AS kt ON kt.kind IN ('movie', 'episode') AND kt.id = t.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx.info_type_id AND mi_idx.info < '8.5') AS t_mi_idx ON t_mi_idx.movie_id = cc.movie_id JOIN movie_companies AS mc ON mc.movie_id = t_mi_idx.movie_id AND mc.note NOT LIKE '%(usa)%' AND mc.note LIKE '%(200%)%' JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN company_name AS cn ON cn.country_code <> '[us]' AND cn.id = mc.company_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'murder-in-title', 'blood', 'violence') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mk.movie_id AND mi.info IN ('sweden', 'norway', 'germany', 'denmark', 'swedish', 'danish', 'norwegian', 'german', 'usa', 'american') JOIN info_type AS it1 ON it1.info = 'countries' AND it1.id = mi.info_type_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
29a,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind = 'complete+verified' AND cct2.id = cc.status_id JOIN title AS t ON t.title = 'shrek 2' AND t.production_year BETWEEN 2000 AND 2010 AND t.id = cc.movie_id JOIN movie_companies AS mc ON mc.movie_id = cc.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'computer-animation' AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(voice)', '(voice) (uncredited)', '(voice: english version)') JOIN char_name AS chn ON chn.name = 'queen' AND chn.id = ci.person_role_id JOIN role_type AS rt ON rt.role = 'actress' AND rt.id = ci.role_id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%an%' AND n.id = an.person_id JOIN (SELECT person_id FROM person_info AS pi JOIN info_type AS it3 ON it3.info = 'trivia' AND it3.id = pi.info_type_id) AS t_pi ON t_pi.person_id = an.person_id JOIN movie_info AS mi ON mi.movie_id = ci.movie_id AND mi.info IS NOT NULL AND (mi.info LIKE 'japan:%200%' OR mi.info LIKE 'usa:%200%') JOIN info_type AS it ON it.info = 'release dates' AND it.id = mi.info_type_id","/*+
IndexOnlyScan(k)
IndexOnlyScan(it3)
NestLoop(mk k)
NestLoop(pi it3)

*/"
29b,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind = 'complete+verified' AND cct2.id = cc.status_id JOIN title AS t ON t.title = 'shrek 2' AND t.production_year BETWEEN 2000 AND 2005 AND t.id = cc.movie_id JOIN movie_companies AS mc ON mc.movie_id = cc.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'computer-animation' AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mc.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(voice)', '(voice) (uncredited)', '(voice: english version)') JOIN char_name AS chn ON chn.name = 'queen' AND chn.id = ci.person_role_id JOIN role_type AS rt ON rt.role = 'actress' AND rt.id = ci.role_id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%an%' AND n.id = an.person_id JOIN (SELECT person_id FROM person_info AS pi JOIN info_type AS it3 ON it3.info = 'height' AND it3.id = pi.info_type_id) AS t_pi ON t_pi.person_id = an.person_id JOIN movie_info AS mi ON mi.movie_id = ci.movie_id AND mi.info LIKE 'usa:%200%' JOIN info_type AS it ON it.info = 'release dates' AND it.id = mi.info_type_id","/*+
IndexOnlyScan(k)
IndexOnlyScan(it3)
NestLoop(mk k)
NestLoop(pi it3)

*/"
29c,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind = 'complete+verified' AND cct2.id = cc.status_id JOIN title AS t ON t.production_year BETWEEN 2000 AND 2010 AND t.id = cc.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'computer-animation' AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = cc.movie_id JOIN movie_companies AS mc ON mc.movie_id = t_mk.movie_id JOIN company_name AS cn ON cn.country_code = '[us]' AND cn.id = mc.company_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id AND ci.note IN ('(voice)', '(voice: japanese version)', '(voice) (uncredited)', '(voice: english version)') JOIN role_type AS rt ON rt.role = 'actress' AND rt.id = ci.role_id JOIN char_name AS chn ON chn.id = ci.person_role_id JOIN aka_name AS an ON an.person_id = ci.person_id JOIN name AS n ON n.gender = 'f' AND n.name LIKE '%an%' AND n.id = an.person_id JOIN (SELECT person_id FROM person_info AS pi JOIN info_type AS it3 ON it3.info = 'trivia' AND it3.id = pi.info_type_id) AS t_pi ON t_pi.person_id = an.person_id JOIN movie_info AS mi ON mi.movie_id = ci.movie_id AND mi.info IS NOT NULL AND (mi.info LIKE 'japan:%200%' OR mi.info LIKE 'usa:%200%') JOIN info_type AS it ON it.info = 'release dates' AND it.id = mi.info_type_id","/*+
IndexOnlyScan(k)
IndexOnlyScan(it3)
NestLoop(mk k)
NestLoop(pi it3)

*/"
30a,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct2 ON cct2.kind = 'complete+verified' AND cct2.id = cc.status_id JOIN comp_cast_type AS cct1 ON cct1.kind IN ('cast', 'crew') AND cct1.id = cc.subject_id JOIN title AS t ON t.production_year > 2000 AND t.id = cc.movie_id JOIN movie_info AS mi ON mi.movie_id = cc.movie_id AND mi.info IN ('horror', 'thriller') JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = mi.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = t_mi_idx.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.gender = 'm' AND n.id = ci.person_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
30b,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct2 ON cct2.kind = 'complete+verified' AND cct2.id = cc.status_id JOIN comp_cast_type AS cct1 ON cct1.kind IN ('cast', 'crew') AND cct1.id = cc.subject_id JOIN title AS t ON t.production_year > 2000 AND (t.title LIKE '%freddy%' OR t.title LIKE '%jason%' OR t.title LIKE 'saw%') AND t.id = cc.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = cc.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mi_idx.movie_id AND mi.info IN ('horror', 'thriller') JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.gender = 'm' AND n.id = ci.person_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
30c,"SELECT COUNT(*) FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.kind = 'cast' AND cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.kind = 'complete+verified' AND cct2.id = cc.status_id JOIN title AS t ON t.id = cc.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = cc.movie_id JOIN movie_info AS mi ON mi.movie_id = t_mi_idx.movie_id AND mi.info IN ('horror', 'action', 'sci-fi', 'thriller', 'crime', 'war') JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = mi.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.gender = 'm' AND n.id = ci.person_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
31a,"SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id AND mi.info IN ('horror', 'thriller') JOIN title AS t ON t.id = mi.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = mi.movie_id JOIN (SELECT movie_id FROM movie_companies AS mc JOIN company_name AS cn ON cn.name LIKE 'lionsgate%' AND cn.id = mc.company_id) AS t_mc ON t_mc.movie_id = t_mi_idx.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = t_mc.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.gender = 'm' AND n.id = ci.person_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(cn)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mc cn)
NestLoop(mk k)

*/"
31b,"SELECT COUNT(*) FROM movie_companies AS mc JOIN company_name AS cn ON cn.name LIKE 'lionsgate%' AND cn.id = mc.company_id AND mc.note LIKE '%(blu-ray)%' JOIN title AS t ON t.production_year > 2000 AND (t.title LIKE '%freddy%' OR t.title LIKE '%jason%' OR t.title LIKE 'saw%') AND t.id = mc.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = mc.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = t_mi_idx.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.gender = 'm' AND n.id = ci.person_id JOIN movie_info AS mi ON mi.movie_id = ci.movie_id AND mi.info IN ('horror', 'thriller') JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mk k)

*/"
31c,"SELECT COUNT(*) FROM movie_info AS mi JOIN info_type AS it1 ON it1.info = 'genres' AND it1.id = mi.info_type_id AND mi.info IN ('horror', 'action', 'sci-fi', 'thriller', 'crime', 'war') JOIN title AS t ON t.id = mi.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx JOIN info_type AS it2 ON it2.info = 'votes' AND it2.id = mi_idx.info_type_id) AS t_mi_idx ON t_mi_idx.movie_id = mi.movie_id JOIN (SELECT movie_id FROM movie_companies AS mc JOIN company_name AS cn ON cn.name LIKE 'lionsgate%' AND cn.id = mc.company_id) AS t_mc ON t_mc.movie_id = t_mi_idx.movie_id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital') AND k.id = mk.keyword_id) AS t_mk ON t_mk.movie_id = t_mc.movie_id JOIN cast_info AS ci ON ci.movie_id = t_mk.movie_id AND ci.note IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)') JOIN name AS n ON n.id = ci.person_id","/*+
IndexOnlyScan(it2)
IndexOnlyScan(cn)
IndexOnlyScan(k)
NestLoop(mi_idx it2)
NestLoop(mc cn)
NestLoop(mk k)

*/"
32a,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.id = ml.link_type_id JOIN title AS t1 ON ml.movie_id = t1.id JOIN title AS t2 ON ml.linked_movie_id = t2.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = '10,000-mile-club' AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = ml.movie_id","/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
32b,SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.id = ml.link_type_id JOIN title AS t1 ON ml.movie_id = t1.id JOIN title AS t2 ON ml.linked_movie_id = t2.id JOIN (SELECT movie_id FROM movie_keyword AS mk JOIN keyword AS k ON k.keyword = 'character-name-in-title' AND mk.keyword_id = k.id) AS t_mk ON t_mk.movie_id = ml.movie_id,"/*+
IndexOnlyScan(k)
NestLoop(mk k)

*/"
33a,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link IN ('sequel', 'follows', 'followed by') AND lt.id = ml.link_type_id JOIN title AS t2 ON t2.production_year BETWEEN 2005 AND 2008 AND t2.id = ml.linked_movie_id JOIN title AS t1 ON t1.id = ml.movie_id JOIN kind_type AS kt1 ON kt1.kind IN ('tv series') AND kt1.id = t1.kind_id JOIN kind_type AS kt2 ON kt2.kind IN ('tv series') AND kt2.id = t2.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx1 JOIN info_type AS it1 ON it1.info = 'rating' AND it1.id = mi_idx1.info_type_id) AS t_mi_idx1 ON t_mi_idx1.movie_id = ml.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx2 JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx2.info_type_id AND mi_idx2.info < '3.0') AS t_mi_idx2 ON t_mi_idx2.movie_id = ml.linked_movie_id JOIN movie_companies AS mc2 ON mc2.movie_id = ml.linked_movie_id JOIN company_name AS cn2 ON cn2.id = mc2.company_id JOIN movie_companies AS mc1 ON mc1.movie_id = ml.movie_id JOIN company_name AS cn1 ON cn1.country_code = '[us]' AND cn1.id = mc1.company_id","/*+
IndexOnlyScan(it1)
IndexOnlyScan(it2)
NestLoop(mi_idx1 it1)
NestLoop(mi_idx2 it2)

*/"
33b,SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link LIKE '%follow%' AND lt.id = ml.link_type_id JOIN title AS t2 ON t2.production_year = 2007 AND t2.id = ml.linked_movie_id JOIN title AS t1 ON t1.id = ml.movie_id JOIN kind_type AS kt1 ON kt1.kind IN ('tv series') AND kt1.id = t1.kind_id JOIN kind_type AS kt2 ON kt2.kind IN ('tv series') AND kt2.id = t2.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx1 JOIN info_type AS it1 ON it1.info = 'rating' AND it1.id = mi_idx1.info_type_id) AS t_mi_idx1 ON t_mi_idx1.movie_id = ml.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx2 JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx2.info_type_id AND mi_idx2.info < '3.0') AS t_mi_idx2 ON t_mi_idx2.movie_id = ml.linked_movie_id JOIN movie_companies AS mc2 ON mc2.movie_id = ml.linked_movie_id JOIN company_name AS cn2 ON cn2.id = mc2.company_id JOIN movie_companies AS mc1 ON mc1.movie_id = ml.movie_id JOIN company_name AS cn1 ON cn1.country_code = '[nl]' AND cn1.id = mc1.company_id,"/*+
IndexOnlyScan(it1)
IndexOnlyScan(it2)
NestLoop(mi_idx1 it1)
NestLoop(mi_idx2 it2)

*/"
33c,"SELECT COUNT(*) FROM movie_link AS ml JOIN link_type AS lt ON lt.link IN ('sequel', 'follows', 'followed by') AND lt.id = ml.link_type_id JOIN title AS t2 ON t2.production_year BETWEEN 2000 AND 2010 AND t2.id = ml.linked_movie_id JOIN title AS t1 ON t1.id = ml.movie_id JOIN kind_type AS kt1 ON kt1.kind IN ('tv series', 'episode') AND kt1.id = t1.kind_id JOIN kind_type AS kt2 ON kt2.kind IN ('tv series', 'episode') AND kt2.id = t2.kind_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx1 JOIN info_type AS it1 ON it1.info = 'rating' AND it1.id = mi_idx1.info_type_id) AS t_mi_idx1 ON t_mi_idx1.movie_id = ml.movie_id JOIN (SELECT movie_id FROM movie_info_idx AS mi_idx2 JOIN info_type AS it2 ON it2.info = 'rating' AND it2.id = mi_idx2.info_type_id AND mi_idx2.info < '3.5') AS t_mi_idx2 ON t_mi_idx2.movie_id = ml.linked_movie_id JOIN movie_companies AS mc2 ON mc2.movie_id = ml.linked_movie_id JOIN company_name AS cn2 ON cn2.id = mc2.company_id JOIN movie_companies AS mc1 ON mc1.movie_id = ml.movie_id JOIN company_name AS cn1 ON cn1.country_code <> '[us]' AND cn1.id = mc1.company_id","/*+
IndexOnlyScan(it1)
IndexOnlyScan(it2)
NestLoop(mi_idx1 it1)
NestLoop(mi_idx2 it2)

*/"
